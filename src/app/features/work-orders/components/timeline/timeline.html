<div class="timeline-grid-wrapper">
    <div class="timeline-header">
        <div class="timeline-header-content">
            @for (column of timelineColumns(); track column.date) {
                <div
                    class="timeline-column"
                    [class.current-month]="column.isCurrent"
                >
                    <div class="column-label">{{ column.label }}</div>
                    @if (column.isCurrent) {
                        <div class="current-month-label">Current month</div>
                    }
                </div>
            }
        </div>
    </div>

    <div class="timeline-body">
        <div class="timeline-grid-background">
            @for (column of timelineColumns(); track column.date) {
                <div class="grid-column-bg"></div>
            }
        </div>

        @if (currentTimeLinePosition() !== null) {
            <div
                class="current-time-line"
                [style.left.px]="currentTimeLinePosition()"
            ></div>
        }

        @for (center of workCenters(); track center.docId; let rowIndex = $index) {
            <div
                class="timeline-row"
                [style.width.px]="timelineWidth()"
                (click)="_onRowClick($event, center)"
                (mousemove)="_onRowMouseMove($event, rowIndex, center.docId)"
                (mouseleave)="_onRowMouseLeave()"
            >
                @if (hoverState().visible && hoverState().rowIndex === rowIndex) {
                    <div
                        class="cell-hover-indicator"
                        [style.left.px]="hoverState().left"
                    ></div>
                }

                <div class="work-orders-layer">
                    @for (order of workOrders() | workOrdersForCenter : center.docId; track order.docId) {
                        <app-work-order-bar
                            [order]="order"
                            [zoomLevel]="zoomLevel()"
                            [timelineColumns]="timelineColumns()"
                        ></app-work-order-bar>
                    }
                </div>
            </div>
        }
    </div>
</div>
